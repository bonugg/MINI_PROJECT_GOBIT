<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
    <meta charset="UTF-8">
    <title>Empty</title>
    <th:block layout:fragment="css">
        <!--사용할 css는 여기에 첨부 -->
        <link rel="stylesheet" type="text/css" href="/css/empty.css">
        <link rel="stylesheet" type="text/css" href="/css/boardDept/dboardList.css">

    </th:block>
</head>
<body layout:fragment="content">
<div id="fullscreen">
    <div id="_emt1"></div>
    <div id="_emt2">
        <div id="_emt3">
        </div>
        <div id="_emt4">
            <div id="use_screen">
                <!--헤더와 메뉴바를 제외한 영역 -->
                <!--여기에 본인의 코드를 넣어주시면 됩니다 -->
                <div>
                    <div class="heead">
                        <div class="div-title">
                            <div class="title">
                                <label>부서게시판</label>
                            </div>
                        </div>
                    </div>

                    <div class="boody">
                        <!-- 검색 창 -->
                        <div class="div-search">
                            <div class="div-sort">
                                <a class="sort-btn" href="/boardDept/sorted-by-cnt">조회순</a>
                                <a class="sort-btn" href="/boardDept/sorted-by-like">인기순</a>
                            </div>

                            <div class="search-value">
                                <select class="search-select" th:value="${category}" id="search_category">
                                    <option value="전체">전체</option>
                                    <option value="제목">제목</option>
                                    <option value="내용">내용</option>
                                    <option value="작성자">작성자</option>
                                </select>
                                <input class="search-input" type="text" th:value="${kw}" id="search_kw" placeholder="검색어를 입력하세요.">
                                <button class="search-btn" type="button" id="btn_search">검색</button>

                            </div>
                        </div>
                        <!-- 검색 창 -->

                        <!-- 게시판 테이블 -->
                        <table class="board-table">
                            <thead>
                            <tr>
                                <th class="table-no">번호</th>
                                <th class="table-title">제목</th>
                                <th class="table-name">이름</th>
                                <th class="table-date">작성일자</th>
                                <th class="table-cnt">조회수</th>
                                <th class="table-like">추천수</th>
                            </tr>
                            </thead>
                            <tbody><tr th:each="board, loop : ${paging}">
<!--                                <td th:text="${paging.getTotalElements - (paging.number * paging.size) - loop.index}"></td>-->
                                <td th:text="${board.id}"></td>
                                <td class="table-title">
                                    <a th:href="@{|/boardDept/updateCnt/${board.id}|}"
                                    th:text="${board.title}"></a>
                                </td>
                                <td class="table-name" th:if="${board.user != null}" th:text="${board.user.USERNAME}"></td>
                                <td class="table-date" th:text="${#temporals.format(board.createDate, 'yyyy-MM-dd HH:mm')}"></td>
                                <td class="table-cnt" th:text="${board.cnt}"></td>
                                <td class="table-like" th:text="${board.like}"></td>
                            </tr>

                            </tbody>
                        </table>
                        <!-- 게시판 테이블 -->


                        <!-- 페이징처리 시작 -->
                        <div class="paging" th:if="${!paging.isEmpty()}">
                            <ul>

                                <li th:if="${paging.hasPrevious()}" style="margin-right: 3px">
                                    <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number-1}">
                                        이전
                                    </a>
                                </li>
                                 <li th:each="page: ${#numbers.sequence(0, paging.totalPages-1)}" style="margin-right: 3px"
                                     th:if="${page >= paging.number-2 and page <= paging.number+2}"
                                     th:class="${page+1 == currentPage ? 'active-page' : ''}">
                                    <a th:text="${page+1}" class="page-link" href="javascript:void(0)" th:data-page="${page}"></a>
                                </li>
                                <li th:if="${paging.hasNext()}">
                                    <a class="page-link" href="javascript:void(0)" th:data-page="${paging.number+1}">
                                        다음
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="div-writeBtn">
                            <a href="/boardDept/create">글쓰기</a>
                        </div>

                        <!-- 페이징처리 끝 -->
                    </div>
                    <form th:action="@{/boardDept/list}" method="get" id="searchForm">
                        <input type="hidden" id="category" name="category" th:value="${category}">
                        <input type="hidden" id="kw" name="kw" th:value="${kw}">
                        <input type="hidden" id="page" name="page" th:value="${paging.number}">
                    </form>
                </div>


            </div>
        </div>
    </div>
</div>
<script>
    const page_elements = document.getElementsByClassName("page-link");
    Array.from(page_elements).forEach(function(element) {
        element.addEventListener('click', function() {
            document.getElementById('page').value = this.dataset.page;
            document.getElementById('searchForm').submit();
        });
    });
    const btn_search = document.getElementById("btn_search");
    btn_search.addEventListener('click', function() {
        document.getElementById('category').value = document.getElementById('search_category').value;
        document.getElementById('kw').value = document.getElementById('search_kw').value;
        document.getElementById('page').value = 0;  // 검색버튼을 클릭할 경우 0페이지부터 조회한다.
        document.getElementById('searchForm').submit();
    });
</script>
</body>
<th:block layout:fragment="script">
    <!--사용할 자바스크립트는 여기에 첨부 -->

</th:block>
</html>